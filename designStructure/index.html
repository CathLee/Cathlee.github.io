<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="CL&love" href="https://cathlee.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="CL&love" href="https://cathlee.github.io/atom.xml"><link rel="alternate" type="application/json" title="CL&love" href="https://cathlee.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="结构型模式"><link rel="canonical" href="https://cathlee.github.io/designStructure/"><title>设计模式之结构型模式 - 设计模式 | CLee = CL&love = 厚积而薄发，博观而约取。</title><meta name="generator" content="Hexo 5.4.2"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">设计模式之结构型模式</h1><div class="meta"><span class="item" title="创建时间：2021-06-08 21:24:23"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-06-08T21:24:23+08:00">2021-06-08</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>7.6k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>7 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">CLee</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://api.ucany.net/acg-pc?318929"></li><li class="item" data-background-image="https://api.ucany.net/acg-pc?20120"></li><li class="item" data-background-image="https://api.ucany.net/acg-pc?958425"></li><li class="item" data-background-image="https://api.ucany.net/acg-pc?66308"></li><li class="item" data-background-image="https://api.ucany.net/acg-pc?387871"></li><li class="item" data-background-image="https://api.ucany.net/acg-pc?165542"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="item" rel="index" title="分类于 设计模式"><span itemprop="name">设计模式</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://cathlee.github.io/designStructure/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="神烦大眼怪"><meta itemprop="description" content="厚积而薄发，博观而约取。, 三思而行"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="CL&love"></span><div class="body md" itemprop="articleBody"><h3 id="1适配器模式"><a class="anchor" href="#1适配器模式">#</a> 1. 适配器模式</h3><p>含义：字面意思相当于” 转换接头 “。</p><p>适配器的模式结构</p><p><strong>1. 对象适配器</strong></p><p>​ <strong>构成原则</strong>：实现了其中一个对象的接口（service），并对另一个对象 (client) 进行封装。</p><p>​ <strong>含义</strong>：对象适配器相当于银行柜姐；大致流程如下</p><p><img data-src="struct01.png" alt="image-20210608214200520"></p><ul><li><strong>客户端</strong> （Client） 是包含当前程序业务逻辑的类。</li><li><strong>客户端接口</strong> （Client Interface） 描述了其他类与客户端代码合作时必须遵循的协议。</li><li><strong>服务</strong> （Service） 中有一些功能类 （通常来自第三方或遗留系统）。 客户端与其接口不兼容， 因此无法直接调用其功能。</li><li><strong>适配器</strong> （Adapter） 是一个可以同时与客户端和服务交互的类： 它在实现客户端接口的同时封装了服务对象。 适配器接受客户端通过适配器接口发起的调用， 并将其转换为适用于被封装服务对象的调用。</li><li>客户端代码只需通过接口与适配器交互即可， 无需与具体的适配器类耦合。 因此， 你可以向程序中添加新类型的适配器而无需修改已有代码。 这在服务类的接口被更改或替换时很有用： 你无需修改客户端代码就可以创建新的适配器类。</li></ul><p><strong>2. 类适配器</strong></p><p>​	构成原则：适配器同时<strong>实现了对两个对象的继承</strong>。（注：这种方式仅仅只能在支持多重继承的编程语言中实现，如 c++)。</p><p>​	含义：直接将适配器 Adapter 作为当前客户端和其他客户端合作的载体而无<strong>需当前客户端进行事件的参与 -- 即最后生成的适配器可替代已有的客户端类进行使用</strong>。</p><p><img data-src="struct02.png" alt="image-20210614223756728"></p><h4 id="应用背景"><a class="anchor" href="#应用背景">#</a> <strong>应用背景</strong></h4><p><img data-src="struct03.png" alt="image-20210614225325466"></p><p>类适配器伪代码：</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 假设你有两个接口相互兼容的类：圆孔（Round­Hole）和圆钉（Round­Peg）。</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">RoundHole</span> is</pre></td></tr><tr><td data-num="3"></td><td><pre>    constructor <span class="token class-name">RoundHole</span><span class="token punctuation">(</span>radius<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>    method <span class="token function">getRadius</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token comment">// 返回孔的半径。</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    method <span class="token function">fits</span><span class="token punctuation">(</span>peg<span class="token operator">:</span> <span class="token class-name">RoundPeg</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRadius</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> peg<span class="token punctuation">.</span><span class="token function">getRadius</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">RoundPeg</span> is</pre></td></tr><tr><td data-num="12"></td><td><pre>    constructor <span class="token class-name">RoundPeg</span><span class="token punctuation">(</span>radius<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>    method <span class="token function">getRadius</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token comment">// 返回钉子的半径。</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// 但还有一个不兼容的类：方钉（Square­Peg）。</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SquarePeg</span> is</pre></td></tr><tr><td data-num="20"></td><td><pre>    constructor <span class="token class-name">SquarePeg</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    method <span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token comment">// 返回方钉的宽度。</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">// 适配器类让你能够将方钉放入圆孔中。它会对 RoundPeg 类进行扩展，以接收适</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">// 配器对象作为圆钉。</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SquarePegAdapter</span> <span class="token keyword">extends</span> <span class="token class-name">RoundPeg</span> is</pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token comment">// 在实际情况中，适配器中会包含一个 SquarePeg 类的实例。</span></pre></td></tr><tr><td data-num="30"></td><td><pre> </pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token comment">// 这里是重中之重，Adapter 的作用就是 “承上启下”</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    </pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">private</span> field peg<span class="token operator">:</span> <span class="token class-name">SquarePeg</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>    constructor <span class="token class-name">SquarePegAdapter</span><span class="token punctuation">(</span>peg<span class="token operator">:</span> <span class="token class-name">SquarePeg</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>peg <span class="token operator">=</span> peg</pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>    method <span class="token function">getRadius</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token comment">// 适配器会假扮为一个圆钉，</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token comment">// 其半径刚好能与适配器实际封装的方钉搭配起来。</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token keyword">return</span> peg<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>        </pre></td></tr><tr><td data-num="44"></td><td><pre>        </pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token comment">// 函数调用</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token comment">// 客户端代码中的某个位置。</span></pre></td></tr><tr><td data-num="47"></td><td><pre>hole <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RoundHole</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>rpeg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RoundPeg</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>hole<span class="token punctuation">.</span><span class="token function">fits</span><span class="token punctuation">(</span>rpeg<span class="token punctuation">)</span> <span class="token comment">// true</span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre>small_sqpeg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SquarePeg</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre>large_sqpeg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SquarePeg</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre>hole<span class="token punctuation">.</span><span class="token function">fits</span><span class="token punctuation">(</span>small_sqpeg<span class="token punctuation">)</span> <span class="token comment">// 此处无法编译（类型不一致）。</span></pre></td></tr><tr><td data-num="54"></td><td><pre></pre></td></tr><tr><td data-num="55"></td><td><pre>small_sqpeg_adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SquarePegAdapter</span><span class="token punctuation">(</span>small_sqpeg<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre>large_sqpeg_adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SquarePegAdapter</span><span class="token punctuation">(</span>large_sqpeg<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre>        </pre></td></tr><tr><td data-num="58"></td><td><pre>hole<span class="token punctuation">.</span><span class="token function">fits</span><span class="token punctuation">(</span>small_sqpeg_adapter<span class="token punctuation">)</span> <span class="token comment">//true，这里很关键</span></pre></td></tr><tr><td data-num="59"></td><td><pre>        </pre></td></tr><tr><td data-num="60"></td><td><pre>hole<span class="token punctuation">.</span><span class="token function">fits</span><span class="token punctuation">(</span>large_sqpeg_adapter<span class="token punctuation">)</span> <span class="token comment">// false</span></pre></td></tr></table></figure><p><strong>注意的点：</strong></p><p>类适配器在使用的时候采用 <code>class Adapter extend Service implement ClientInterface</code></p><p>对象适配器使用的时候采用 <code>class Adapter implement ClientInterface</code></p><p>Java 代码：<span class="exturl" data-url="aHR0cHM6Ly9yZWZhY3RvcmluZ2d1cnUuY24vZGVzaWduLXBhdHRlcm5zL2FkYXB0ZXIvamF2YS9leGFtcGxl">https://refactoringguru.cn/design-patterns/adapter/java/example</span></p><hr><h3 id="2桥接模式"><a class="anchor" href="#2桥接模式">#</a> 2. 桥接模式</h3><p>简而言之，就是个遥控器，将两个维度变化的事物进行交互使用。实现的是对象的<strong>组合</strong>而非继承。</p><p>比如说：如下例子我们在代码工厂制作多颜色的物体时，首先要明确 1. 做的是什么形状的物体（球形？方形）2. 等把这个物体建模建好了之后，才能添加诸如颜色（蓝色？红色？）的属性。</p><p>在这种背景下，给我们的对象拓展会带来一定程度的麻烦，比如说下图：我们想要拓展一个颜色（比如说粉色）时，不能仅仅拓展一个颜色而已，拓展完粉色球体和粉色正方体之后，才能完完全全包含所有可能的形状颜色组合。这样一来，我们每次拓展的种类数，每次都要呈指数式增加，这样会带来极大的不便性。</p><p><img data-src="image-20210615110950706.png" alt="image-20210615110950706"></p><p>于是我们选择下面这种 “<strong>抽象 -- 实现</strong>” 的方式来进行重构</p><p><img data-src="image-20210615111937609.png" alt="image-20210615111937609"></p><p>将颜色类独立出来，当作形状类的接口，供形状调用，每次要增加颜色时，只需要对接口进行拓展即可。</p><h4 id="1什么是抽象-实现"><a class="anchor" href="#1什么是抽象-实现">#</a> 1. 什么是抽象 - 实现</h4><p>上文我们提到<strong>抽象 - 实现</strong>一词，这个说法主要是源于桥接模式的官方定义：</p><p><em><strong>抽象部分</strong></em> （也被称为<em>接口</em>） 是一些实体的高阶控制层。 该层自身不完成任何具体的工作， 它需要将工作委派给<em><strong>实现部分</strong></em>层 （也被称为<em>平台</em>）</p><p>简而言之，就是 “遥控器”，点哪指哪，要啥干啥。</p><p>需要注意的是对遥控器而言，具体的内部实现是透明的。</p><h4 id="结构"><a class="anchor" href="#结构">#</a> 结构：</h4><p><img data-src="./designStructure/image-20210615140539345.png" alt="image-20210615140539345"></p><h4 id="应用背景-2"><a class="anchor" href="#应用背景-2">#</a> 应用背景：</h4><p><img data-src="image-20210615140611359.png" alt="image-20210615140611359"></p><p>伪代码：</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// “抽象部分” 定义了两个类层次结构中 “控制” 部分的接口。</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 它管理着一个指向 “实现部分” 层次结构中对象的引用，并会将所有真实工作委派给该对象。</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">RemoteControl</span> is</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">protected</span> field device<span class="token operator">:</span> <span class="token class-name">Device</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    constructor <span class="token class-name">RemoteControl</span><span class="token punctuation">(</span>device<span class="token operator">:</span> <span class="token class-name">Device</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>device <span class="token operator">=</span> device</pre></td></tr><tr><td data-num="7"></td><td><pre>    method <span class="token function">togglePower</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>device<span class="token punctuation">.</span><span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> then</pre></td></tr><tr><td data-num="9"></td><td><pre>            device<span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">else</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            device<span class="token punctuation">.</span><span class="token function">enable</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    method <span class="token function">volumeDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="13"></td><td><pre>        device<span class="token punctuation">.</span><span class="token function">setVolume</span><span class="token punctuation">(</span>device<span class="token punctuation">.</span><span class="token function">getVolume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    method <span class="token function">volumeUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="15"></td><td><pre>        device<span class="token punctuation">.</span><span class="token function">setVolume</span><span class="token punctuation">(</span>device<span class="token punctuation">.</span><span class="token function">getVolume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    method <span class="token function">channelDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="17"></td><td><pre>        device<span class="token punctuation">.</span><span class="token function">setChannel</span><span class="token punctuation">(</span>device<span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    method <span class="token function">channelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="19"></td><td><pre>        device<span class="token punctuation">.</span><span class="token function">setChannel</span><span class="token punctuation">(</span>device<span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">// 你可以独立于设备类的方式从抽象层中扩展类。</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">AdvancedRemoteControl</span> <span class="token keyword">extends</span> <span class="token class-name">RemoteControl</span> is</pre></td></tr><tr><td data-num="24"></td><td><pre>    method <span class="token function">mute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="25"></td><td><pre>        device<span class="token punctuation">.</span><span class="token function">setVolume</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">// “实现部分” 接口声明了在所有具体实现类中通用的方法。它不需要与抽象接口相</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">// 匹配。实际上，这两个接口可以完全不一样。通常实现接口只提供原语操作，而</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">// 抽象接口则会基于这些操作定义较高层次的操作。</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">interface</span> <span class="token class-name">Device</span> is</pre></td></tr><tr><td data-num="32"></td><td><pre>    method <span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    method <span class="token function">enable</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    method <span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    method <span class="token function">getVolume</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    method <span class="token function">setVolume</span><span class="token punctuation">(</span>percent<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    method <span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    method <span class="token function">setChannel</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token comment">// 所有设备都遵循相同的接口。</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Tv</span> <span class="token keyword">implements</span> <span class="token class-name">Device</span> is</pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token comment">// ...</span></pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Radio</span> <span class="token keyword">implements</span> <span class="token class-name">Device</span> is</pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token comment">// ...</span></pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token comment">// 客户端代码中的某个位置。</span></pre></td></tr><tr><td data-num="50"></td><td><pre>tv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tv</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>remote <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RemoteControl</span><span class="token punctuation">(</span>tv<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre>remote<span class="token punctuation">.</span><span class="token function">togglePower</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre>radio <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Radio</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre>remote <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AdvancedRemoteControl</span><span class="token punctuation">(</span>radio<span class="token punctuation">)</span></pre></td></tr></table></figure><p><strong>优点</strong>：</p><p>​	满足了：</p><ul><li>单一职责原则</li><li>开闭原则</li><li>透明性</li></ul><p>缺点： 对<strong>高内聚</strong>的类使用该模式可能会让代码更加复杂</p><p><span class="exturl" data-url="aHR0cHM6Ly9yZWZhY3RvcmluZ2d1cnUuY24vZGVzaWduLXBhdHRlcm5zL2JyaWRnZS9qYXZhL2V4YW1wbGU=">https://refactoringguru.cn/design-patterns/bridge/java/example</span></p><hr><h3 id="3组合模式"><a class="anchor" href="#3组合模式">#</a> 3. 组合模式</h3><p>简而言之，组合模式就是只对树的分支进行递归调用。即将对象组合成树状结构，并且能像独立对象一样使用它们。</p><p>组合模式的执行方式相当于：在部队里，干什么事情都是由长官先发号施令，再由下级人员分配任务执行。</p><p><img data-src="image-20210615150817388.png" alt="image-20210615150817388"></p><h4 id="结构-2"><a class="anchor" href="#结构-2">#</a> 结构</h4><p><img data-src="image-20210615150955689.png" alt="image-20210615150955689"></p><h4 id="应用背景-3"><a class="anchor" href="#应用背景-3">#</a> 应用背景</h4><p><img data-src="image-20210615151635898.png" alt="image-20210615151635898"></p><h4 id="透明组合"><a class="anchor" href="#透明组合">#</a> 透明组合</h4><p><img data-src="image-20210615151823380.png" alt="image-20210615151823380"></p><h4 id="安全组合"><a class="anchor" href="#安全组合">#</a> 安全组合</h4><p><img data-src="image-20210615152023478.png" alt="image-20210615152023478"></p><p>优点：</p><ul><li>添加新的构件变得容易</li><li>递归</li><li>包含了叶子对象和容器对象的类层次结构</li></ul><p>缺点：</p><ul><li>抽象性，需要把握共性并糅合在一起。</li></ul><hr><h3 id="4装饰模式"><a class="anchor" href="#4装饰模式">#</a> 4. 装饰模式</h3><p>简而言之，装饰模式的过程就像穿衣服，天气热可以穿短袖，天气冷可以加件外套，天气再次变热的时候可以随时脱掉外套。</p><h4 id="结构-3"><a class="anchor" href="#结构-3">#</a> 结构</h4><p><img data-src="image-20210615194927985.png" alt="image-20210615194927985"></p><ol><li><strong>部件</strong> （Component） 声明封装器和被封装对象的公用接口。</li><li><strong>具体部件</strong> （Concrete Component） 类是被封装对象所属的类。 它定义了基础行为， 但装饰类可以改变这些行为。</li><li><strong>基础装饰</strong> （Base Decorator） 类拥有一个指向被封装对象的引用成员变量。 该变量的类型应当被声明为通用部件接口， 这样它就可以引用具体的部件和装饰。 装饰基类会将所有操作委派给被封装的对象。</li><li><strong>具体装饰类</strong> （Concrete Decorators） 定义了可动态添加到部件的额外行为。 具体装饰类会重写装饰基类的方法， 并在调用父类方法之前或之后进行额外的行为。</li><li><strong>客户端</strong> （Client） 可以使用多层装饰来封装部件， 只要它能使用通用接口与所有对象互动即可。</li></ol><h4 id="应用背景-4"><a class="anchor" href="#应用背景-4">#</a> 应用背景</h4><p>对敏感数据进行压缩和加密， 从而将数据从使用数据的代码中独立出来。</p><p><img data-src="image-20210615195055234.png" alt="image-20210615195055234"></p><p>伪代码</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 装饰可以改变组件接口所定义的操作。</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">interface</span> <span class="token class-name">DataSource</span> is</pre></td></tr><tr><td data-num="3"></td><td><pre>    method <span class="token function">writeData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    method <span class="token function">readData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>data</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 具体组件提供操作的默认实现。这些类在程序中可能会有几个变体。</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">FileDataSource</span> <span class="token keyword">implements</span> <span class="token class-name">DataSource</span> is</pre></td></tr><tr><td data-num="8"></td><td><pre>    constructor <span class="token class-name">FileDataSource</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    method <span class="token function">writeData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token comment">// 将数据写入文件。</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>    method <span class="token function">readData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>data is</pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token comment">// 从文件读取数据。</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// 装饰基类和其他组件遵循相同的接口。该类的主要任务是定义所有具体装饰的封</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">// 装接口。封装的默认实现代码中可能会包含一个保存被封装组件的成员变量，并</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// 且负责对其进行初始化。</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">DataSourceDecorator</span> <span class="token keyword">implements</span> <span class="token class-name">DataSource</span> is</pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">protected</span> field wrappee<span class="token operator">:</span> <span class="token class-name">DataSource</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    constructor <span class="token class-name">DataSourceDecorator</span><span class="token punctuation">(</span>source<span class="token operator">:</span> <span class="token class-name">DataSource</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="23"></td><td><pre>        wrappee <span class="token operator">=</span> source</pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token comment">// 装饰基类会直接将所有工作分派给被封装组件。具体装饰中则可以新增一些</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token comment">// 额外的行为。</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    method <span class="token function">writeData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="28"></td><td><pre>        wrappee<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token comment">// 具体装饰可调用其父类的操作实现，而不是直接调用被封装对象。这种方式</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token comment">// 可简化装饰类的扩展工作。</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    method <span class="token function">readData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>data is</pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">return</span> wrappee<span class="token punctuation">.</span><span class="token function">readData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">// 具体装饰必须在被封装对象上调用方法，不过也可以自行在结果中添加一些内容。</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment">// 装饰必须在调用封装对象之前或之后执行额外的行为。</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">EncryptionDecorator</span> <span class="token keyword">extends</span> <span class="token class-name">DataSourceDecorator</span> is</pre></td></tr><tr><td data-num="38"></td><td><pre>    method <span class="token function">writeData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token comment">// 1. 对传递数据进行加密。</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token comment">// 2. 将加密后数据传递给被封装对象 writeData（写入数据）方法。</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre>    method <span class="token function">readData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>data is</pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token comment">// 1. 通过被封装对象的 readData（读取数据）方法获取数据。</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token comment">// 2. 如果数据被加密就尝试解密。</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token comment">// 3. 返回结果。</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token comment">// 你可以将对象封装在多层装饰中。</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">CompressionDecorator</span> <span class="token keyword">extends</span> <span class="token class-name">DataSourceDecorator</span> is</pre></td></tr><tr><td data-num="49"></td><td><pre>    method <span class="token function">writeData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token comment">// 1. 压缩传递数据。</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token comment">// 2. 将压缩后数据传递给被封装对象 writeData（写入数据）方法。</span></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre>    method <span class="token function">readData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>data is</pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token comment">// 1. 通过被封装对象的 readData（读取数据）方法获取数据。</span></pre></td></tr><tr><td data-num="55"></td><td><pre>        <span class="token comment">// 2. 如果数据被压缩就尝试解压。</span></pre></td></tr><tr><td data-num="56"></td><td><pre>        <span class="token comment">// 3. 返回结果。</span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token comment">// 选项 1：装饰组件的简单示例</span></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Application</span> is</pre></td></tr><tr><td data-num="61"></td><td><pre>    method <span class="token function">dumbUsageExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="62"></td><td><pre>        source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileDataSource</span><span class="token punctuation">(</span><span class="token string">"somefile.dat"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre>        source<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span>salaryRecords<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token comment">// 已将明码数据写入目标文件。</span></pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre>        source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompressionDecorator</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="67"></td><td><pre>        source<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span>salaryRecords<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="68"></td><td><pre>        <span class="token comment">// 已将压缩数据写入目标文件。</span></pre></td></tr><tr><td data-num="69"></td><td><pre></pre></td></tr><tr><td data-num="70"></td><td><pre>        source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EncryptionDecorator</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="71"></td><td><pre>        <span class="token comment">// 源变量中现在包含：</span></pre></td></tr><tr><td data-num="72"></td><td><pre>        <span class="token comment">// Encryption > Compression > FileDataSource</span></pre></td></tr><tr><td data-num="73"></td><td><pre>        source<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span>salaryRecords<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="74"></td><td><pre>        <span class="token comment">// 已将压缩且加密的数据写入目标文件。</span></pre></td></tr><tr><td data-num="75"></td><td><pre></pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token comment">// 选项 2：客户端使用外部数据源。SalaryManager（工资管理器）对象并不关心</span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token comment">// 数据如何存储。它们会与提前配置好的数据源进行交互，数据源则是通过程序配</span></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token comment">// 置器获取的。</span></pre></td></tr><tr><td data-num="80"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SalaryManager</span> is</pre></td></tr><tr><td data-num="81"></td><td><pre>    field source<span class="token operator">:</span> <span class="token class-name">DataSource</span></pre></td></tr><tr><td data-num="82"></td><td><pre></pre></td></tr><tr><td data-num="83"></td><td><pre>    constructor <span class="token class-name">SalaryManager</span><span class="token punctuation">(</span>source<span class="token operator">:</span> <span class="token class-name">DataSource</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="84"></td><td><pre></pre></td></tr><tr><td data-num="85"></td><td><pre>    method <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="86"></td><td><pre>        <span class="token keyword">return</span> source<span class="token punctuation">.</span><span class="token function">readData</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="87"></td><td><pre></pre></td></tr><tr><td data-num="88"></td><td><pre>    method <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="89"></td><td><pre>        source<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span>salaryRecords<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="90"></td><td><pre>    <span class="token comment">//... 其他有用的方法...</span></pre></td></tr><tr><td data-num="91"></td><td><pre></pre></td></tr><tr><td data-num="92"></td><td><pre></pre></td></tr><tr><td data-num="93"></td><td><pre><span class="token comment">// 程序可在运行时根据配置或环境组装不同的装饰堆桟。</span></pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">ApplicationConfigurator</span> is</pre></td></tr><tr><td data-num="95"></td><td><pre>    method <span class="token function">configurationExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="96"></td><td><pre>        source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileDataSource</span><span class="token punctuation">(</span><span class="token string">"salary.dat"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="97"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>enabledEncryption<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="98"></td><td><pre>            source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EncryptionDecorator</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="99"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>enabledCompression<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="100"></td><td><pre>            source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CompressionDecorator</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="101"></td><td><pre></pre></td></tr><tr><td data-num="102"></td><td><pre>        logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SalaryManager</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="103"></td><td><pre>        salary <span class="token operator">=</span> logger<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="104"></td><td><pre>    <span class="token comment">// ...</span></pre></td></tr></table></figure><p>使用场景</p><p>动态</p><p>透明</p><p>给单个对象添加职责</p><p>可以动态的被撤销</p><h3 id="5外观模式"><a class="anchor" href="#5外观模式">#</a> 5. 外观模式</h3><p>亦称门面模式，能为程序库、 框架或其他复杂类提供一个简单的接口。</p><p>简而言之，当你通过电话给商店下达订单时，接线员就是该商店的 “外观”，她为你提供了一个 ---- 同购物系统、 支付网关和各种送货服务进行互动的简单语音<strong>接口</strong>。</p><h4 id="结构-4"><a class="anchor" href="#结构-4">#</a> 结构</h4><p><img data-src="image-20210615222052873.png" alt="image-20210615222052873"></p><ol><li><p><strong>外观</strong> （Facade） 提供了一种访问特定子系统功能的便捷方式， 其了解如何重定向客户端请求， 知晓如何操作一切活动部件。</p></li><li><p>创建<strong>附加外观</strong> （Additional Facade） 类可以避免多种不相关的功能污染单一外观， 使其变成又一个复杂结构。 客户端和其他外观都可使用附加外观。</p></li><li><p><strong>复杂子系统</strong> （Complex Subsystem） 由数十个不同对象构成。 如果要用这些对象完成有意义的工作， 你必须深入了解子系统的实现细节， 比如按照正确顺序初始化对象和为其提供正确格式的数据。</p><p>子系统类不会意识到外观的存在， 它们在系统内运作并且相互之间可直接进行交互。</p></li><li><p><strong>客户端</strong> （Client） 使用外观代替对子系统对象的直接调用。</p></li></ol><p>伪代码：</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 这里有复杂第三方视频转换框架中的一些类。我们不知晓其中的代码，因此无法</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 对其进行简化。</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">VideoFile</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// ...</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">OggCompressionCodec</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// ...</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MPEG4CompressionCodec</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// ...</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">CodecFactory</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// ...</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">BitrateReader</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">// ...</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">AudioMixer</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">// ...</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">// 为了将框架的复杂性隐藏在一个简单接口背后，我们创建了一个外观类。它是在</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">// 功能性和简洁性之间做出的权衡。</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">VideoConverter</span> is</pre></td></tr><tr><td data-num="26"></td><td><pre>    method <span class="token function">convert</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> format<span class="token punctuation">)</span><span class="token operator">:</span><span class="token class-name">File</span> is</pre></td></tr><tr><td data-num="27"></td><td><pre>        file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VideoFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        sourceCodec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CodecFactory</span><span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>format <span class="token operator">==</span> <span class="token string">"mp4"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            destinationCodec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MPEG4CompressionCodec</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token keyword">else</span></pre></td></tr><tr><td data-num="32"></td><td><pre>            destinationCodec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OggCompressionCodec</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        buffer <span class="token operator">=</span> <span class="token class-name">BitrateReader</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> sourceCodec<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        result <span class="token operator">=</span> <span class="token class-name">BitrateReader</span><span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> destinationCodec<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AudioMixer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fix</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment">// 应用程序的类并不依赖于复杂框架中成千上万的类。同样，如果你决定更换框架，</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token comment">// 那只需重写外观类即可。</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Application</span> is</pre></td></tr><tr><td data-num="41"></td><td><pre>    method <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> is</pre></td></tr><tr><td data-num="42"></td><td><pre>        convertor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VideoConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        mp4 <span class="token operator">=</span> convertor<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token string">"funny-cats-video.ogg"</span><span class="token punctuation">,</span> <span class="token string">"mp4"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        mp4<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="使用场景"><a class="anchor" href="#使用场景">#</a> 使用场景：</h4><ol><li><strong>如果你需要一个指向复杂子系统的直接接口，且该接口的功能有限则可以使用外观模式</strong>。</li><li><strong>如果需要将子系统组织为多层结构可以使用外观</strong></li></ol><p>优点：可以让自动代码独立于复杂的子系统</p><hr><div class="tags"><a href="/tags/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/" rel="tag"><i class="ic i-tag"></i> 结构型模式</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-03-19 15:40:00" itemprop="dateModified" datetime="2022-03-19T15:40:00+08:00">2022-03-19</time> </span><span id="designStructure/" class="item leancloud_visitors" data-flag-title="设计模式之结构型模式" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="神烦大眼怪 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="神烦大眼怪 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="神烦大眼怪 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>神烦大眼怪 <i class="ic i-at"><em>@</em></i>CL&love</li><li class="link"><strong>本文链接：</strong> <a href="https://cathlee.github.io/designStructure/" title="设计模式之结构型模式">https://cathlee.github.io/designStructure/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/designCreated/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;api.ucany.net&#x2F;acg-pc?90460" title="设计模式之创建型模式"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 设计模式</span><h3>设计模式之创建型模式</h3></a></div><div class="item right"><a href="/cs/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;api.ucany.net&#x2F;acg-pc?915774" title="计算机组成原理"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 计算机组成原理</span><h3>计算机组成原理</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.</span> <span class="toc-text">1. 适配器模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E8%83%8C%E6%99%AF"><span class="toc-number">1.1.</span> <span class="toc-text">应用背景</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.</span> <span class="toc-text">2. 桥接模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E4%BB%80%E4%B9%88%E6%98%AF%E6%8A%BD%E8%B1%A1-%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.1.</span> <span class="toc-text">1. 什么是抽象 - 实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84"><span class="toc-number">2.2.</span> <span class="toc-text">结构：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E8%83%8C%E6%99%AF-2"><span class="toc-number">2.3.</span> <span class="toc-text">应用背景：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text">3. 组合模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84-2"><span class="toc-number">3.1.</span> <span class="toc-text">结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E8%83%8C%E6%99%AF-3"><span class="toc-number">3.2.</span> <span class="toc-text">应用背景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%8F%E6%98%8E%E7%BB%84%E5%90%88"><span class="toc-number">3.3.</span> <span class="toc-text">透明组合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E7%BB%84%E5%90%88"><span class="toc-number">3.4.</span> <span class="toc-text">安全组合</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F"><span class="toc-number">4.</span> <span class="toc-text">4. 装饰模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84-3"><span class="toc-number">4.1.</span> <span class="toc-text">结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E8%83%8C%E6%99%AF-4"><span class="toc-number">4.2.</span> <span class="toc-text">应用背景</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F"><span class="toc-number">5.</span> <span class="toc-text">5. 外观模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%84-4"><span class="toc-number">5.1.</span> <span class="toc-text">结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">5.2.</span> <span class="toc-text">使用场景：</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/designPattern/" rel="bookmark" title="设计模式之创建型模式">设计模式之创建型模式</a></li><li><a href="/designCreated/" rel="bookmark" title="设计模式之创建型模式">设计模式之创建型模式</a></li><li class="active"><a href="/designStructure/" rel="bookmark" title="设计模式之结构型模式">设计模式之结构型模式</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="神烦大眼怪" data-src="/images/avatar.jpg"><p class="name" itemprop="name">神烦大眼怪</p><div class="description" itemprop="description">三思而行</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">17</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">8</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">12</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0NhdGhsZWU=" title="https:&#x2F;&#x2F;github.com&#x2F;Cathlee"><i class="ic i-github"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS9hbWVoaW1l" title="https:&#x2F;&#x2F;about.me&#x2F;amehime"><i class="ic i-address-card"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/designCreated/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/cs/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="分类于 计算机组成原理">计算机组成原理</a></div><span><a href="/cs/" title="计算机组成原理">计算机组成原理</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%97%A5%E8%AE%B0/" title="分类于 日记">日记</a></div><span><a href="/NLP/" title="NLP">NLP</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 数据结构">数据结构</a></div><span><a href="/algorithm-Graph/" title="图的算法">图的算法</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="分类于 设计模式">设计模式</a></div><span><a href="/designCreated/" title="设计模式之创建型模式">设计模式之创建型模式</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/vue/" title="分类于 vue">vue</a></div><span><a href="/vue%E5%8F%98%E5%8C%96%E4%BE%A6%E6%B5%8B/" title="vue变化侦测">vue变化侦测</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/vite/" title="分类于 vite">vite</a></div><span><a href="/vite/" title="vite无法require图片资源--vite踩坑日记day01">vite无法require图片资源--vite踩坑日记day01</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/vue/" title="分类于 vue">vue</a></div><span><a href="/props/" title="关于Vue中Props的源码部分解析">关于Vue中Props的源码部分解析</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 数据结构">数据结构</a></div><span><a href="/someCode/" title="数组矩阵">数组矩阵</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%98%A5%E6%8B%9B/" title="分类于 春招">春招</a></div><span><a href="/js/" title="从url到页面展示到底发生了什么？">从url到页面展示到底发生了什么？</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 数据结构">数据结构</a></div><span><a href="/Sort/" title="排序算法">排序算法</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">神烦大眼怪 @ CLee</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">71k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">1:05</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"designStructure/",favicon:{show:"╰(*°▽°*)╯欢迎光临！",hide:"(○´･д･)ﾉ憋走呜呜呜（我装的）！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>